(this["webpackJsonpnext-break"]=this["webpackJsonpnext-break"]||[]).push([[0],{19:function(e,t,n){e.exports=n(39)},24:function(e,t,n){},26:function(e,t,n){},32:function(e,t,n){},36:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(11),i=n.n(s),c=(n(24),n(4)),u=n(1),o=n.n(u),p=n(2),l=n(3),d=n(6),f=n(8),v=n(7),h=(n(26),n(5)),m=(n(32),n(18)),b="Indexed DB not available",x="Unable to open Indexed DB",O=void 0;function w(){return!!window.indexedDB||(console.error("IndexedDB not available"),!1)}function S(){return k.apply(this,arguments)}function k(){return(k=Object(p.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return w()?(O||(O=new m.a("nbDB")).version(1).stores({users:"id, nickname, logoid, createdOn, updatedOn, version",settings:"id, name, value, createdOn, updatedOn, version",plans:"id, name, startTime, constants, variables, createdOn, updatedOn, version",exercises:"id, name, startTime, endTime, tags, currentState, constants, variables, progress, createdOn, updatedOn, version"}),!0!==O.isOpen()&&O.open().catch((function(e){return t(x)})),e(O)):t(b)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=function e(t,n,r,a,s,i){Object(l.a)(this,e),this.id=t,this.nickname=n,this.logoid=r,this.createdOn=a,this.updatedOn=s,this.version=i};function y(e){return E.apply(this,arguments)}function E(){return(E=Object(p.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return n=e.sent,r=new Date,e.next=6,n.users.add({id:t.id,nickname:t.nickname,logoid:t.logoid,createdOn:r,updatedOn:r,version:1});case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return I.apply(this,arguments)}function I(){return(I=Object(p.a)(o.a.mark((function e(){var t,n,r,a,s,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return t=e.sent,e.next=5,t.users.toArray();case 5:n=e.sent,r=[],a=Object(c.a)(n);try{for(a.s();!(s=a.n()).done;)i=s.value,u=new g(i.id,i.nickname,i.logoid,i.createdOn,i.updatedOn,i.version),r.push(u)}catch(o){a.e(o)}finally{a.f()}return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h1",null,"Landing Page"),a.a.createElement("div",null,a.a.createElement("button",{onClick:this.handleStart.bind(this)},"Start as new user")))}},{key:"handleStart",value:function(){var e=Object(p.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="NewUser_"+(new Date).toISOString(),n=new g(t,t,"logo-001"),e.next=4,y(n);case 4:e.sent===t?this.props.dispatch({type:"START_AS_NEW_USER",userName:t}):alert("Error: Unable to create new user");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(a.a.Component),j=Object(h.b)((function(e){return{app:e.app}}))(T),A=(n(36),function e(t,n,r,a,s,i){Object(l.a)(this,e),this.id=t,this.name=n,this.value=r,this.createdOn=a,this.updatedOn=s,this.version=i});function _(e){return D.apply(this,arguments)}function D(){return(D=Object(p.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return n=e.sent,r=new Date,e.next=6,n.settings.add({id:t.id,name:t.name,value:t.value,createdOn:r,updatedOn:r,version:1});case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return C.apply(this,arguments)}function C(){return(C=Object(p.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return n=e.sent,r=new Date,e.next=6,n.settings.put({id:t.id,name:t.name,value:t.value,createdOn:t.createdOn,updatedOn:r,version:1},t.id);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return L.apply(this,arguments)}function L(){return(L=Object(p.a)(o.a.mark((function e(){var t,n,r,a,s,i,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return t=e.sent,e.next=5,t.settings.toArray();case 5:n=e.sent,r=[],a=Object(c.a)(n);try{for(a.s();!(s=a.n()).done;)i=s.value,u=new A(i.id,i.name,i.value,i.createdOn,i.updatedOn,i.version),r.push(u)}catch(o){a.e(o)}finally{a.f()}return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=function e(t,n,r,a,s,i,c,u,o,p,d,f){Object(l.a)(this,e),this.id=t,this.name=n,this.startTime=r&&null!=r?new Date(r):null,this.endTime=a&&null!=a?new Date(a):null,this.tags=s,this.currentState=i,this.constants=c,this.variables=u,this.progress=o,this.createdOn=p,this.updatedOn=d,this.version=f};function W(e){return U.apply(this,arguments)}function U(){return(U=Object(p.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return n=e.sent,r=new Date,e.next=6,n.exercises.add({id:t.id,name:t.name,startTime:t.startTime,endTime:t.endTime,tags:t.tags,currentState:t.currentState,constants:t.constants,variables:t.variables,progress:t.progress,createdOn:r,updatedOn:r,version:1});case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){return B.apply(this,arguments)}function B(){return(B=Object(p.a)(o.a.mark((function e(t,n){var r,a,s,i,u,p,l,d,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return r=e.sent,a=t&&null==t?null:new Date(t),s=n&&null==n?null:new Date(n),e.next=7,r.exercises.filter((function(e){var t=!0;return null!=a&&new Date(e.startTime)<a&&(t=!1),null!=s&&new Date(e.startTime)>=s&&(t=!1),t})).toArray();case 7:i=e.sent,u=[],p=Object(c.a)(i);try{for(p.s();!(l=p.n()).done;)d=l.value,f=new J(d.id,d.name,d.startTime,d.endTime,d.tags,d.currentState,d.constants,d.variables,d.progress,d.createdOn,d.updatedOn,d.version),u.push(f)}catch(o){p.e(o)}finally{p.f()}return e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return q.apply(this,arguments)}function q(){return(q=Object(p.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return n=e.sent,r=new Date,e.next=6,n.exercises.put({id:t.id,name:t.name,startTime:t.startTime,endTime:t.endTime,tags:t.tags,currentState:t.currentState,constants:t.constants,variables:t.variables,progress:t.progress,createdOn:t.createdOn,updatedOn:r,version:1});case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X=n(15),Z=n.n(X);function $(e){return z.apply(this,arguments)}function z(){return(z=Object(p.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.Notification){e.next=5;break}return console.error("Notificaion is not supported in bowser"),e.abrupt("return");case 5:if(n=Notification.permission,"granted"===Notification.permission){e.next=10;break}return e.next=9,window.Notification.requestPermission();case 9:n=e.sent;case 10:"granted"===n?new Notification("".concat(t)).onclick=K():console.error("Notification permission denied");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return H.apply(this,arguments)}function H(){return(H=Object(p.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.Notification){e.next=9;break}if(t=Notification.permission,"granted"===Notification.permission){e.next=6;break}return e.next=5,window.Notification.requestPermission();case 5:t=e.sent;case 6:"granted"===t?new Notification("Notification permission granted"):alert("Notification permission denied, you will not receive notifications"),e.next=10;break;case 9:alert("Error: Notifications not supported");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){console.log("notification got clicked"),window.focus()}var Q=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={isLoaded:!1,exerciseInterval:30},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(o.a.mark((function e(){var t,n,r,a,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,n=null,e.next=4,G();case 4:if(!((r=e.sent)&&r.length>0)){e.next=25;break}a=Object(c.a)(r),e.prev=7,a.s();case 9:if((s=a.n()).done){e.next=17;break}if("exerciseInterval"!==(i=s.value).name){e.next=15;break}return t=!0,n=i,e.abrupt("break",17);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:!0===t&&this.setState({exerciseInterval:n.value}),this.setState({isLoaded:!0});case 27:case"end":return e.stop()}}),e,this,[[7,19,22,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return!0!==this.state.isLoaded?a.a.createElement("div",null,a.a.createElement("h1",null,"Settings Page"),a.a.createElement("div",null,"Loading ...")):a.a.createElement("div",null,a.a.createElement("h1",null,"Settings Page"),a.a.createElement("div",null,"Welcome ",this.props.app.userName," ! Configure settings below -"),a.a.createElement("br",null),a.a.createElement("div",null,"Exercise Interval (mins) :",a.a.createElement("input",{type:"number",value:this.state.exerciseInterval,onChange:this.handleChange.bind(this)}),a.a.createElement("button",{onClick:this.handleSubmit.bind(this)},"Save")))}},{key:"handleChange",value:function(e){this.setState({exerciseInterval:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(p.a)(o.a.mark((function e(){var t,n,r,a,s,i,u,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,n=null,e.next=4,G();case 4:if(!((r=e.sent)&&r.length>0)){e.next=25;break}a=Object(c.a)(r),e.prev=7,a.s();case 9:if((s=a.n()).done){e.next=17;break}if("exerciseInterval"!==(i=s.value).name){e.next=15;break}return t=!0,n=i,e.abrupt("break",17);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:if(!1!==t){e.next=37;break}return u=new A("exerciseInterval","exerciseInterval",{label:"Exercise interval",duration:this.state.exerciseInterval}),e.next=29,_(u);case 29:return p=new J("exercise1","exercise1",new Date(Z()().add(this.state.exerciseInterval,"minutes").toISOString()),new Date(Z()().add(this.state.exerciseInterval,"minutes").add(2,"minute").toISOString()),["neck"],{setsRequired:10,recommendedInterval:2},{setsCompleted:0},0),e.next=32,W(p);case 32:return e.next=34,F();case 34:this.props.dispatch({type:"SETTINGS_CREATED"}),e.next=38;break;case 37:n.value!==this.state.exerciseInterval&&(n.value=this.state.exerciseInterval,R(n));case 38:case"end":return e.stop()}}),e,this,[[7,19,22,25]])})));return function(){return e.apply(this,arguments)}}()}]),n}(a.a.Component),V=Object(h.b)((function(e){return{app:e.app}}))(Q),Y=(n(38),function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={isLoaded:!1,exerciseCount:0},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(new Date);case 2:t=e.sent,n=t.length,this.setState({isLoaded:!0,exerciseCount:n});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return!0!==this.state.isLoaded?a.a.createElement("div",null,a.a.createElement("h1",null,"Waiting Page"),a.a.createElement("div",null,"Loading ...")):a.a.createElement("div",null,a.a.createElement("h1",null,"Waiting Page"),a.a.createElement("div",null,"Number of upcoming exercises : ",this.state.exerciseCount))}}]),n}(a.a.Component)),ee=Object(h.b)((function(e){return{app:e.app}}))(Y),te="INITIALIZING",ne="AWAITING_USER_CREATION",re="AWAITING_USER_SETTINGS",ae="AWAITING_EXERCISE";function se(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(p.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Object.assign({},t)).currentState="PENDING",M(n),e.next=5,$("Its time to Exercise");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ce=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadApp(this.props);case 2:setInterval(function(){var e=Object(p.a)(o.a.mark((function e(){var t,n,r,a,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=new Date((new Date).setMinutes(t.getMinutes()-1)),e.next=4,P(n,t);case 4:if(!((r=e.sent)&&r.length>0)){e.next=23;break}a=Object(c.a)(r),e.prev=7,a.s();case 9:if((s=a.n()).done){e.next=15;break}return i=s.value,e.next=13,se(i);case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[7,17,20,23]])})));return function(){return e.apply(this,arguments)}}(),6e4);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadApp",value:function(){var e=Object(p.a)(o.a.mark((function e(t){var n,r,a,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:if(!((n=e.sent)&&n.length>0)){e.next=31;break}return t.dispatch({type:"LOAD_USER",userName:n[0].nickname}),r=!1,e.next=8,G();case 8:if(!((a=e.sent)&&a.length>0)){e.next=28;break}s=Object(c.a)(a),e.prev=11,s.s();case 13:if((i=s.n()).done){e.next=20;break}if("exerciseInterval"!==i.value.name){e.next=18;break}return r=!0,e.abrupt("break",20);case 18:e.next=13;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(11),s.e(e.t0);case 25:return e.prev=25,s.f(),e.finish(25);case 28:!0===r?t.dispatch({type:"START_AS_AWAITING_EXERCISE"}):t.dispatch({type:"START_AS_AWAITING_USER_SETTINGS"}),e.next=32;break;case 31:t.dispatch({type:"START_ON_LANDING_PAGE"});case 32:case"end":return e.stop()}}),e,null,[[11,22,25,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.app.userState===te?a.a.createElement("div",null,"Loading ..."):this.props.app.userState===ne?a.a.createElement(j,null):this.props.app.userState===re?a.a.createElement(V,null):this.props.app.userState===ae?a.a.createElement(ee,null):a.a.createElement("div",null,"Error : Unknown App State")}}]),n}(a.a.Component),ue=Object(h.b)((function(e){return{app:e.app}}))(ce);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var oe=n(9),pe={userState:te,userName:null},le=Object(oe.b)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;if("START_ON_LANDING_PAGE"===t.type){var n=JSON.parse(JSON.stringify(e));return n.userName=null,n.userState=ne,n}if("START_AS_NEW_USER"===t.type){var r=JSON.parse(JSON.stringify(e));return r.userName=t.userName,r.userState=re,r}if("LOAD_USER"===t.type){var a=JSON.parse(JSON.stringify(e));return a.userName=t.userName,a}if("START_AS_AWAITING_USER_SETTINGS"===t.type){var s=JSON.parse(JSON.stringify(e));return s.userState=re,s}if("START_AS_AWAITING_EXERCISE"===t.type){var i=JSON.parse(JSON.stringify(e));return i.userState=ae,i}if("SETTINGS_CREATED"===t.type){var c=JSON.parse(JSON.stringify(e));return c.userState=ae,c}return e}}),de=Object(oe.c)(le);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(h.a,{store:de},a.a.createElement(ue,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.e73dff11.chunk.js.map